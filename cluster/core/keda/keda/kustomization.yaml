apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
metadata:
  name: keda

namespace: keda

helmCharts:
  - includeCRDs: true
    name: keda
    namespace: keda
    releaseName: keda
    repo: https://kedacore.github.io/charts
    valuesFile: ./values.yaml
    version: 2.15.1

resources:
  - ./resources/namespace.yaml

patches:
  - target:
      kind: RoleBinding
      name: keda-operator-auth-reader
    patch: |-
      - op: add
        path: "/subjects/-"
        value:
          kind: ServiceAccount
          name: keda-operator
          namespace: keda

---

- name: Install "unattended-upgrades" package
  ansible.builtin.apt:
    name: unattended-upgrades
    state: latest
    update_cache: true
  become: true
  tags:
    - packages
    - security
    - unattended-upgrades

- name: Template "/etc/apt/apt.conf.d/20auto-upgrades"
  ansible.builtin.template:
    src: 20auto-upgrades.j2
    dest: /etc/apt/apt.conf.d/20auto-upgrades
    owner: root
    group: root
    mode: 0644
  become: true
  tags:
    - security
    - unattended-upgrades

- name: Template "/etc/apt/apt.conf.d/50unattended-upgrades"
  ansible.builtin.template:
    src: 50unattended-upgrades.j2
    dest: /etc/apt/apt.conf.d/50unattended-upgrades
    owner: root
    group: root
    mode: 0644
  become: true
  tags:
    - security
    - unattended-upgrades

- name: Remove "/etc/apt/apt.conf.d/20auto-upgrades.ucf-dist"
  ansible.builtin.file:
    path: /etc/apt/apt.conf.d/20auto-upgrades.ucf-dist
    state: absent
  become: true
  tags:
    - unattended-upgrades

- name: Remove "/etc/apt/apt.conf.d/50unattended-upgrades.ucf-dist"
  ansible.builtin.file:
    path: /etc/apt/apt.conf.d/50unattended-upgrades.ucf-dist
    state: absent
  become: true
  tags:
    - unattended-upgrades
